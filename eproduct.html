<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="initComponents()">
    <fieldset>
        <legend id="titleLegend"></legend>
        <input type="text" id="iconField" placeholder="icono"/>
        <input type="text" id="nameField" placeholder="nombre"/>
        <input type="text" id="descriptionField" placeholder="description"/>
        <input type="text" id="urlImgField" placeholder="urlImg"/>
        <select id="egenderSelect"></select> 

        <select id="categorySelect"></select> 
        <select id="materialTypeSelect"></select> 
        <input type="text" id="updateField" placeholder="icono de edicion"/>
        <input type="text" id="deleteField" placeholder="icono de eliminacion"/>
        <input type="submit" id="submitButton" />
    </fieldset>
<script>
        const urlSearchParams = new URLSearchParams(window.location.search);
        const id = urlSearchParams.get("id");

        let iconField = null;
        let nameField = null;
        let descriptionField = null;
        let urlImgField = null;

        function initComponents() {
            iconField = document.getElementById("iconField");
            nameField = document.getElementById("nameField");            
            descriptionField = document.getElementById("descriptionField");
            urlImgField = document.getElementById("urlImgField");

            egenderSelect = document.getElementById("egenderSelect");

            const egenderJSON = null;           
            egenderLoadJSON();

            if (id == null) {
                titleLegend.textContent = "Agregar Producto";
                document.getElementById("submitButton").addEventListener("click", save);
            }
                
            else {
                titleLegend.textContent = "Actualizar Producto";
                document.getElementById("submitButton").addEventListener("click", update);
                
            }
            

        }
        function egenderContentLoaded(data){
            let option = document.createElement("option");
            option.text = "Seleccione una Categor√≠a";
            egenderSelect.appendChild(option);
            console.log(data);
            for(let i in egenderJSON){
                option = null;
                option = document.createElement("option");
                option.text = egenderJSON[i].name;
                egenderSelect.appendChild(option);
            }
        }

        async function productByIdLoadJSON(id){
            try{
                const response = await fetch(`http://localhost:8080/api/product/${id}`);
                const data = await response.json();
                productJSON = data;
                console.log(data);

            }
            catch(error){
                console.log(error);
            }

        }
        async function egenderLoadJSON(){
            try{
                const response = await fetch("http://localhost:8080/api/gender");
                const data = await response.json();
                egenderJSON = data;
                document.addEventListener("DOMContentLoaded", egenderContentLoaded(data));
            }
            catch(error){
                console.log(error);
            }
            

            /*
            try {
                const response = await fetch("http://localhost:8080/api/product");
                const data = await response.json();
                productJSON = data;
                document.addEventListener("DOMContentLoaded", domContentLoadProduct(data));
            }
            catch (error) {
                console.log(error);
            }
            
            try{
                const response = await fetch("http://localhost:8080/api/category");
                const data = await response.json();
                categoryJSON = data;
                document.addEventListener("DOMContentLoaded", domContentLoadCategory(data));
            }
            catch(error){
                console.log(error);
            }
            try{
                const response = await fetch("http://localhost:8080/api/materialType");
                const data = await response.json();
                materialTypeJSON = data;
                document.addEventListener("DOMContentLoaded", domContentLoadMaterialType(data));
            }
            catch(error){
                console.log(error);
            }
            */
        }

        function update(){
            console.log(id);
            productByIdLoadJSON(id);
            
        }

        function save(){

        }
</script>
</body>
</html>